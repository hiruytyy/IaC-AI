{"statusCode": 200, "body": "[{\"security_group_id\": \"sg-05d728cd2e4d23a8f\", \"name\": \"test-risky-sg\", \"vpc_id\": \"vpc-0762b6aa881b66b9f\", \"risky_rules\": [{\"port\": 22, \"protocol\": \"tcp\", \"source\": \"0.0.0.0/0\"}], \"attached_resources\": [], \"ai_analysis\": \"1. Threat explanation: The security group has an inbound rule that allows SSH (port 22) access from any IP address (0.0.0.0/0), making it vulnerable to brute-force attacks and unauthorized access attempts from anywhere on the internet. This exposes the resources associated with this security group to potential compromises and data breaches.\\n\\n2. Business impact: This misconfiguration poses a significant risk to the organization's data security and could lead to system compromises, data breaches, and potential regulatory fines or legal issues. It also increases the attack surface, putting the organization's reputation and customer trust at risk.\\n\\n3. Remediation steps:\\n- Restrict the inbound SSH access to trusted IP addresses or a specific IP range only (e.g., your office IP range)\\n- Implement additional security controls like SSH key-based authentication, fail2ban, or AWS Security Groups for further protection\\n- Monitor and review security group configurations regularly\\n- Implement a secure configuration management process for security group changes\\n\\n4. Terraform code to fix:\\n```\\nresource \\\"aws_security_group\\\" \\\"test-risky-sg\\\" {\\n  name   = \\\"test-risky-sg\\\"\\n  vpc_id = \\\"vpc-0762b6aa881b66b9f\\\"\\n\\n  ingress {\\n    from_port   = 22\\n    to_port     = 22\\n    protocol    = \\\"tcp\\\"\\n    cidr_blocks = [\\\"YOUR_OFFICE_IP_RANGE/32\\\"] # Replace with your trusted IP range\\n  }\\n}\\n```\\n\\n5. Compliance violations:\\n- This configuration violates best practices outlined in various security frameworks, such as NIST SP 800-53, CIS AWS Foundations Benchmark, and AWS Well-Architected Framework.\\n- It may also violate industry-specific regulations like PCI DSS, HIPAA, or GDPR, depending on the nature of the data and workloads hosted on the associated resources.\"}]"}